# 网络安全协议作业



## SSL

### 什么是SSL协议

> SSL(Secure Sockets Layer 安全套接层)，及其继任者传输层安全（Transport Layer Security，TLS）是为网络通信提供安全及数据完整性的一种安全协议。TLS与SSL在传输层对网络连接进行加密。 

SSL协议位于TCP/IP协议与各种应用层协议之间，为数据通讯提供安全支持。SSL协议可分为两层： SSL记录协议（SSL Record Protocol）：它建立 在可靠的传输协议（如TCP）之上，为高层协议提供数据封装、压缩、加密等基本功能的支持。 SSL握手协议（SSL Handshake Protocol）：它建 立在SSL记录协议之上，用于在实际的数据传输开始前，通讯双方进行身份认证、协商加密算法、交换加密密钥等。

**SSL提供的服务：**

+ 认证用户和服务器，确保数据发送到正确的客户机和服务器； 
+ 加密数据以防止数据中途被窃取； 
+ 保证数据的完整性，确保数据在传输过程中不被改变。

### SSL工作流程

**服务器认证阶段：**

1. 客户端向服务器发送一个开始信息“Hello”以便开始一个新的会话连接； 
2. 服务器根据客户的信息确定是否需要生成新的主密钥，如需要则服务器在响应客户的“Hello”信息时将包含生成主密钥所需的信息；
3. 客户根据收到的服务器响应信息，产生一个主密钥，并用服务器的公开密钥加密后传给服务器；
4. 服务器回复该主密钥，并返回给客户一个用主密钥认证的信息，以此让客户认证服务器。

**用户认证阶段：**
	在此之前，服务器已经通过了客户认证，这一阶段主要完成对客户的认证。经认证的服务器发送一个提问给客户，客户则返回 （数字）签名后的提问和其公开密钥，从而向服务器提供认证。 

**SSL协议提供的安全通道有以下三个特性：**

+ 机密性：SSL协议使用密钥加密通信数据。 
+ 可靠性：服务器和客户都会被认证，客户的认证是可选的。 
+ 完整性：SSL协议会对传送的数据进行完整性检查。





## SSL配置和启用

### 配置服务器，添加网页

+ 基础配置
  ![配置网页](.\images\配置网页.png)
+ ![配置网页2](.\images\配置网页2.png)



### 虚拟机作为客户端访问

+ 访问
  ![虚拟机web](.\images\虚拟机web.png)



### 抓包查看未配置SSL的传输

+ 明文传输
  ![抓包明文](.\images\抓包明文.png)



### 配置SSL证书

+ 创建自签名证书
  ![证书](.\images\证书.png)
+ 启动SSL和HTTPS服务
  ![添加证书](.\images\添加证书.png)
+ 虚拟机服务端HTTP访问
  ![https访问](.\images\https访问.png)
  + 配置SSL成功，浏览器已使用Https服务。
+ 抓包
  ![ssl抓包](.\images\ssl抓包.png)





## IPSec

### 什么是IPSec

>  互联网安全协议（英语：Internet Protocol Security，缩写为IPsec），是一个协议簇，通过对IP协议的分组进行加密和认证来保护IP协议的网络传输 协议族（一些相互关联的协议的集合）。

 **IPsec主要由以下协议组成：** 

1. 认证头（AH），为IP数据报提供无连接数据完整性、消息认证以及防重放攻击保护；
2. 封装安全载荷（ESP），提供机密性、数据源认证、无连接完整性、防重放和有限的传输流（traffic-flow）机密性；
3.  安全关联（SA），提供算法和数据包，提供AH、ESP操作所需的参数；
4. 密钥协议（IKE），提供对称密码的钥匙的生存和交换。



## IPSec配置和启用

打开本地安全策略管理器

![安全策略](.\images\安全策略.png)

新建安全规则

![安全规则](.\images\安全规则.png)

新建筛选器

![筛选器](.\images\筛选器.png)

筛选器操作配置：

![筛选器操作](.\images\筛选器操作.png)

配置身份验证方法：

![规则](.\images\规则.png)



配置ESP保证完整性和加密：

![ESP](.\images\ESP.png)







